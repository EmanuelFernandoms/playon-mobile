import{a as H,b as L}from"./chunk-XFDSVCZC.js";import{d as D,e as V,g as $,o as B,t as J,u as A,v as U}from"./chunk-IFRWFENO.js";import"./chunk-OJUVZHLW.js";import"./chunk-QUJFQN2Y.js";import"./chunk-FEEG2QC5.js";import"./chunk-SHK2YYVN.js";import"./chunk-23JPK34T.js";import"./chunk-P5KSPTUK.js";import"./chunk-CXLC43CY.js";import"./chunk-RCM5NIA6.js";import"./chunk-7FY2OE2O.js";import"./chunk-DEX3QH37.js";import"./chunk-T27P4ZLZ.js";import"./chunk-VARVFX7A.js";import"./chunk-MTHZ7MWU.js";import"./chunk-WI5MSH4N.js";import"./chunk-5DNE6CQN.js";import"./chunk-CKP3SGE2.js";import"./chunk-AKIS33NR.js";import{a as N}from"./chunk-IRCD4QNX.js";import"./chunk-XIXWUKZM.js";import{$ as h,C as m,F as g,G as o,H as a,I as l,O as M,P as x,Q as p,Y as b,Z as i,_ as f,aa as I,ba as E,eb as F,ga as j,ha as k,ja as S,m as C,n as P,na as R,pa as w,qa as T,sa as z,u as r,w as v,y,zb as _}from"./chunk-GXCPHFE6.js";import"./chunk-IULK653U.js";import"./chunk-IGVXFY24.js";import"./chunk-5TIAO6TV.js";import"./chunk-BANGDX2W.js";import"./chunk-FZQDFHAZ.js";import"./chunk-CLDSZD2A.js";import"./chunk-M2X7KQLB.js";import"./chunk-DVVH2KKN.js";import"./chunk-NV3QH4JK.js";import"./chunk-XTVTS2NW.js";import"./chunk-OZYWYLNK.js";import"./chunk-42C7ZIID.js";import{e as u}from"./chunk-JHI3MBHO.js";function G(t,s){t&1&&(o(0,"div",5),l(1,"ion-spinner"),o(2,"p"),i(3,"Carregando reserva..."),a()())}function K(t,s){if(t&1&&(o(0,"p",27),i(1),a()),t&2){let e=p(2);r(),E(" R$ ",e.calcularValorPorJogador().toFixed(2)," por jogador (",e.jogadores.length," ",e.jogadores.length===1?"jogador":"jogadores",") ")}}function Q(t,s){if(t&1&&(o(0,"div",28),l(1,"ion-icon",29),o(2,"div")(3,"p",16),i(4,"Observa\xE7\xF5es"),a(),o(5,"p",17),i(6),a()()()),t&2){let e=p(2);r(6),f(e.reserva.observacoes)}}function W(t,s){if(t&1){let e=M();o(0,"ion-button",33),x("click",function(){C(e);let c=p(3);return P(c.entrarNaReserva())}),l(1,"ion-icon",34),i(2," Entrar na Reserva "),a()}}function X(t,s){if(t&1){let e=M();o(0,"ion-button",35),x("click",function(){C(e);let c=p(3);return P(c.sairDaReserva())}),l(1,"ion-icon",36),i(2," Sair da Reserva "),a()}}function Z(t,s){if(t&1&&(o(0,"div",30),m(1,W,3,0,"ion-button",31)(2,X,3,0,"ion-button",32),a()),t&2){let e=p(2);r(),g("ngIf",!e.usuarioEstaNaReserva),r(),g("ngIf",e.usuarioEstaNaReserva)}}function ee(t,s){t&1&&(o(0,"div",37),l(1,"ion-icon",38),o(2,"p"),i(3,"Esta reserva j\xE1 foi realizada. N\xE3o \xE9 poss\xEDvel entrar ou sair."),a()())}function te(t,s){t&1&&(o(0,"div",39),l(1,"ion-icon",40),o(2,"p"),i(3,"Nenhum jogador cadastrado nesta reserva."),a()())}function ne(t,s){if(t&1&&(o(0,"p",49),i(1),a()),t&2){let e=p().$implicit;r(),f(e.email)}}function oe(t,s){if(t&1&&(o(0,"p",50),i(1),a()),t&2){let e=p().$implicit;r(),f(e.telefone)}}function ae(t,s){if(t&1&&(o(0,"div",43),l(1,"ion-icon",44),o(2,"div",45)(3,"p",46),i(4),a(),m(5,ne,2,1,"p",47)(6,oe,2,1,"p",48),a()()),t&2){let e=s.$implicit;r(4),f(e.nome_completo||"Jogador"),r(),g("ngIf",e.email),r(),g("ngIf",e.telefone)}}function re(t,s){if(t&1&&(o(0,"div",41),m(1,ae,7,3,"div",42),a()),t&2){let e=p(2);r(),g("ngForOf",e.jogadores)}}function ie(t,s){if(t&1&&(o(0,"div",6)(1,"div",7)(2,"div",8),l(3,"ion-icon",9),o(4,"h1"),i(5),a()(),o(6,"div",10),i(7),a()(),o(8,"div",11)(9,"h2",12),i(10,"Informa\xE7\xF5es da Reserva"),a(),o(11,"div",13)(12,"div",14),l(13,"ion-icon",15),o(14,"div")(15,"p",16),i(16,"Data"),a(),o(17,"p",17),i(18),a()()(),o(19,"div",14),l(20,"ion-icon",18),o(21,"div")(22,"p",16),i(23,"Hor\xE1rio"),a(),o(24,"p",17),i(25),a()()(),o(26,"div",14),l(27,"ion-icon",19),o(28,"div")(29,"p",16),i(30,"Valor Total"),a(),o(31,"p",17),i(32),a(),m(33,K,2,3,"p",20),a()(),o(34,"div",14),l(35,"ion-icon",21),o(36,"div")(37,"p",16),i(38,"Pagamento"),a(),o(39,"p",17),i(40),a()()()(),m(41,Q,7,1,"div",22),a(),m(42,Z,3,2,"div",23)(43,ee,4,0,"div",24),o(44,"div",11)(45,"h2",12),i(46,"Jogadores"),a(),m(47,te,4,0,"div",25)(48,re,2,1,"div",26),a()()),t&2){let e=p();r(5),f(e.reserva.nome_esporte),r(),b("status-confirmada",e.reserva.status==="confirmada")("status-pendente",e.reserva.status!=="confirmada"),r(),h(" ",e.reserva.status," "),r(11),f(e.formatarData(e.reserva.data)),r(7),I("",e.formatarHorario(e.reserva.hora_inicio)," - ",e.formatarHorario(e.reserva.hora_fim)),r(7),h("R$ ",e.reserva.valor),r(),g("ngIf",e.jogadores.length>0),r(6),b("pago",e.reserva.pagamentos_status==="pago"),r(),h(" ",e.reserva.pagamentos_status," "),r(),g("ngIf",e.reserva.observacoes),r(),g("ngIf",!e.carregando&&e.reserva&&!e.reservaJaPassou()),r(),g("ngIf",!e.carregando&&e.reserva&&e.reservaJaPassou()),r(4),g("ngIf",e.jogadores.length===0),r(),g("ngIf",e.jogadores.length>0)}}var Ce=(()=>{let s=class s{constructor(n,c,d,O,q,Y){this.http=n,this.route=c,this.router=d,this.authService=O,this.loadingController=q,this.toastController=Y,this.reserva=null,this.jogadores=[],this.reservaId=0,this.carregando=!0,this.usuarioAtual=null,this.usuarioEstaNaReserva=!1}ngOnInit(){this.route.params.subscribe(n=>{this.reservaId=+n.id,this.reservaId&&(this.carregarReserva(),this.carregarJogadores())})}carregarReserva(){this.carregando=!0,this.http.get(`${_.apiBaseUrl}/getBookingById?id=${this.reservaId}`).subscribe({next:n=>{this.reserva=n,this.carregando=!1,console.log("Reserva:",n)},error:n=>{console.error("Erro ao carregar reserva:",n),this.carregando=!1}})}carregarJogadores(){this.http.get(`${_.apiBaseUrl}/getPlayersBookingById?id=${this.reservaId}`).subscribe({next:n=>{this.jogadores=n,this.verificarUsuarioNaReserva(),console.log("Jogadores:",n)},error:n=>{console.error("Erro ao carregar jogadores:",n)}})}verificarUsuarioNaReserva(){this.usuarioAtual=this.authService.getCurrentUser(),this.usuarioAtual&&this.jogadores.length>0?this.usuarioEstaNaReserva=this.jogadores.some(n=>n.id===this.usuarioAtual.id):this.usuarioEstaNaReserva=!1}reservaJaPassou(){return!this.reserva||!this.reserva.data||!this.reserva.hora_fim?!1:new Date(`${this.reserva.data}T${this.reserva.hora_fim}`)<new Date}calcularValorPorJogador(){return!this.reserva||!this.reserva.valor||!this.jogadores||this.jogadores.length===0?0:parseFloat(this.reserva.valor)/this.jogadores.length}entrarNaReserva(){return u(this,null,function*(){if(!this.usuarioAtual){this.showToast("Voc\xEA precisa estar logado para entrar na reserva","danger");return}let n=yield this.loadingController.create({message:"Entrando na reserva..."});yield n.present();let c={id_usuario:this.usuarioAtual.id,id_reserva:this.reservaId};this.http.put(`${_.apiBaseUrl}/registerPlayersBooking`,c).subscribe({next:d=>{n.dismiss(),d===!0||d==="true"?(this.showToast("Voc\xEA entrou na reserva com sucesso!","success"),this.carregarJogadores()):this.showToast("Erro ao entrar na reserva","danger")},error:d=>{n.dismiss(),console.error("Erro ao entrar na reserva:",d),this.showToast("Erro ao entrar na reserva. Tente novamente.","danger")}})})}sairDaReserva(){return u(this,null,function*(){if(!this.usuarioAtual)return;let n=yield this.loadingController.create({message:"Saindo da reserva..."});yield n.present();let c={id_usuario:this.usuarioAtual.id,id_reserva:this.reservaId};this.http.request("DELETE",`${_.apiBaseUrl}/deletePlayersBooking`,{body:c}).subscribe({next:d=>{n.dismiss(),this.showToast("Voc\xEA saiu da reserva","success"),this.carregarJogadores()},error:d=>{n.dismiss(),console.error("Erro ao sair da reserva:",d),this.showToast("Erro ao sair da reserva. Tente novamente.","danger")}})})}showToast(n,c="success"){return u(this,null,function*(){yield(yield this.toastController.create({message:n,duration:3e3,color:c,position:"bottom"})).present()})}formatarHorario(n){return n?n.substring(0,5):""}formatarData(n){return n?new Date(n).toLocaleDateString("pt-BR",{day:"2-digit",month:"2-digit",year:"numeric"}):""}voltar(){this.router.navigate(["/home"])}};s.\u0275fac=function(c){return new(c||s)(v(R),v(T),v(z),v(N),v(J),v(A))},s.\u0275cmp=y({type:s,selectors:[["app-reserva"]],decls:8,vars:3,consts:[[1,"ion-padding",3,"fullscreen"],["fill","clear",1,"back-button",3,"click"],["name","arrow-back-outline","slot","start"],["class","loading-container",4,"ngIf"],["class","reserva-detalhes",4,"ngIf"],[1,"loading-container"],[1,"reserva-detalhes"],[1,"reserva-header-detalhes"],[1,"reserva-esporte-header"],["name","football-outline"],[1,"reserva-status-badge"],[1,"info-section"],[1,"section-title"],[1,"info-grid"],[1,"info-item"],["name","calendar-outline"],[1,"info-label"],[1,"info-value"],["name","time-outline"],["name","cash-outline"],["class","info-value-divided",4,"ngIf"],["name","card-outline"],["class","info-item-full",4,"ngIf"],["class","action-buttons",4,"ngIf"],["class","reserva-passada-message",4,"ngIf"],["class","empty-state",4,"ngIf"],["class","jogadores-list",4,"ngIf"],[1,"info-value-divided"],[1,"info-item-full"],["name","document-text-outline"],[1,"action-buttons"],["expand","block","class","action-button entrar-button",3,"click",4,"ngIf"],["expand","block","fill","outline","color","danger","class","action-button sair-button",3,"click",4,"ngIf"],["expand","block",1,"action-button","entrar-button",3,"click"],["name","person-add-outline","slot","start"],["expand","block","fill","outline","color","danger",1,"action-button","sair-button",3,"click"],["name","person-remove-outline","slot","start"],[1,"reserva-passada-message"],["name","lock-closed-outline"],[1,"empty-state"],["name","people-outline"],[1,"jogadores-list"],["class","jogador-item",4,"ngFor","ngForOf"],[1,"jogador-item"],["name","person-circle-outline"],[1,"jogador-info"],[1,"jogador-nome"],["class","jogador-email",4,"ngIf"],["class","jogador-telefone",4,"ngIf"],[1,"jogador-email"],[1,"jogador-telefone"]],template:function(c,d){c&1&&(l(0,"app-navbar"),o(1,"ion-content",0)(2,"ion-button",1),x("click",function(){return d.voltar()}),l(3,"ion-icon",2),i(4," Voltar "),a(),m(5,G,4,0,"div",3)(6,ie,49,19,"div",4),a(),l(7,"app-footer")),c&2&&(r(),g("fullscreen",!0),r(4),g("ngIf",d.carregando),r(),g("ngIf",!d.carregando&&d.reserva))},dependencies:[S,j,k,F,U,D,V,$,B,w,H,L],styles:[".ion-padding[_ngcontent-%COMP%]{--background: var(--background-color, #ffffff) !important;background-color:var(--background-color, #ffffff)!important;padding-bottom:80px!important}ion-content[_ngcontent-%COMP%]{--background: var(--background-color, #ffffff) !important;background-color:var(--background-color, #ffffff)!important}.back-button[_ngcontent-%COMP%]{--color: var(--primary-color, #5900F8) !important;--background: rgba(89, 0, 248, .08) !important;--background-hover: rgba(89, 0, 248, .12) !important;--background-activated: rgba(89, 0, 248, .16) !important;--border-radius: 12px;--padding-start: 12px;--padding-end: 16px;--padding-top: 8px;--padding-bottom: 8px;margin:16px 0;font-weight:600;font-size:15px;text-transform:none;letter-spacing:.3px;box-shadow:0 2px 4px #5900f81a;transition:all .2s ease}.back-button[_ngcontent-%COMP%]:hover{transform:translateY(-1px);box-shadow:0 4px 8px #5900f826}.back-button[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{color:var(--primary-color, #5900F8)!important;font-size:20px;margin-right:4px}.loading-container[_ngcontent-%COMP%]{text-align:center;padding:40px 20px}.loading-container[_ngcontent-%COMP%]   ion-spinner[_ngcontent-%COMP%]{margin-bottom:16px}.loading-container[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:var(--text-secondary, #666666)!important;font-size:14px}.reserva-detalhes[_ngcontent-%COMP%]   .action-buttons[_ngcontent-%COMP%]{margin:24px 0}.reserva-detalhes[_ngcontent-%COMP%]   .action-buttons[_ngcontent-%COMP%]   .action-button[_ngcontent-%COMP%]{margin-bottom:12px;height:48px;font-weight:600;text-transform:none}.reserva-detalhes[_ngcontent-%COMP%]   .action-buttons[_ngcontent-%COMP%]   .action-button.entrar-button[_ngcontent-%COMP%]{--background: var(--primary-color, #5900F8) !important;--color: #ffffff !important}.reserva-detalhes[_ngcontent-%COMP%]   .action-buttons[_ngcontent-%COMP%]   .action-button.sair-button[_ngcontent-%COMP%]{--border-color: #eb445a !important;--color: #eb445a !important}.reserva-detalhes[_ngcontent-%COMP%]   .reserva-passada-message[_ngcontent-%COMP%]{margin:24px 0;padding:20px;background:var(--card-background, #f8f9fa)!important;border-radius:12px;text-align:center;border:1px solid var(--border-color, #e0e0e0)!important}.reserva-detalhes[_ngcontent-%COMP%]   .reserva-passada-message[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:48px;color:var(--text-secondary, #999999)!important;margin-bottom:12px}.reserva-detalhes[_ngcontent-%COMP%]   .reserva-passada-message[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:var(--text-secondary, #666666)!important;font-size:14px;margin:0}.reserva-detalhes[_ngcontent-%COMP%]   .reserva-header-detalhes[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:24px;padding-bottom:16px;border-bottom:2px solid var(--border-color, #f0f0f0)!important}.reserva-detalhes[_ngcontent-%COMP%]   .reserva-header-detalhes[_ngcontent-%COMP%]   .reserva-esporte-header[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px}.reserva-detalhes[_ngcontent-%COMP%]   .reserva-header-detalhes[_ngcontent-%COMP%]   .reserva-esporte-header[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:32px;color:var(--primary-color, #5900F8)!important}.reserva-detalhes[_ngcontent-%COMP%]   .reserva-header-detalhes[_ngcontent-%COMP%]   .reserva-esporte-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{color:var(--text-color, #000000)!important;font-size:24px;font-weight:700;margin:0}.reserva-detalhes[_ngcontent-%COMP%]   .reserva-header-detalhes[_ngcontent-%COMP%]   .reserva-status-badge[_ngcontent-%COMP%]{padding:8px 16px;border-radius:20px;font-size:14px;font-weight:600;text-transform:capitalize}.reserva-detalhes[_ngcontent-%COMP%]   .reserva-header-detalhes[_ngcontent-%COMP%]   .reserva-status-badge.status-confirmada[_ngcontent-%COMP%]{background:#d4edda;color:#155724!important}.reserva-detalhes[_ngcontent-%COMP%]   .reserva-header-detalhes[_ngcontent-%COMP%]   .reserva-status-badge.status-pendente[_ngcontent-%COMP%]{background:#fff3cd;color:#856404!important}.info-section[_ngcontent-%COMP%]{margin-bottom:32px}.info-section[_ngcontent-%COMP%]   .section-title[_ngcontent-%COMP%]{color:var(--text-color, #000000)!important;font-size:20px;font-weight:600;margin:0 0 20px}.info-section[_ngcontent-%COMP%]   .info-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:16px;margin-bottom:20px}@media (max-width: 768px){.info-section[_ngcontent-%COMP%]   .info-grid[_ngcontent-%COMP%]{grid-template-columns:1fr}}.info-section[_ngcontent-%COMP%]   .info-item[_ngcontent-%COMP%]{display:flex;gap:12px;padding:16px;background:var(--card-background, #f8f9fa)!important;border-radius:8px;align-items:flex-start}.info-section[_ngcontent-%COMP%]   .info-item[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:24px;color:var(--primary-color, #5900F8)!important;margin-top:2px;flex-shrink:0}.info-section[_ngcontent-%COMP%]   .info-item[_ngcontent-%COMP%]   .info-label[_ngcontent-%COMP%]{color:var(--text-secondary, #666666)!important;font-size:12px;font-weight:600;text-transform:uppercase;margin:0 0 4px;letter-spacing:.5px}.info-section[_ngcontent-%COMP%]   .info-item[_ngcontent-%COMP%]   .info-value[_ngcontent-%COMP%]{color:var(--text-color, #000000)!important;font-size:16px;font-weight:500;margin:0;text-transform:capitalize}.info-section[_ngcontent-%COMP%]   .info-item[_ngcontent-%COMP%]   .info-value.pago[_ngcontent-%COMP%]{color:#155724!important;font-weight:600}.info-section[_ngcontent-%COMP%]   .info-item[_ngcontent-%COMP%]   .info-value-divided[_ngcontent-%COMP%]{color:var(--text-secondary, #666666)!important;font-size:13px;font-weight:400;margin:4px 0 0;font-style:italic}.info-section[_ngcontent-%COMP%]   .info-item-full[_ngcontent-%COMP%]{display:flex;gap:12px;padding:16px;background:var(--card-background, #f8f9fa);border-radius:8px;align-items:flex-start}.info-section[_ngcontent-%COMP%]   .info-item-full[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:24px;color:var(--primary-color, #5900F8)!important;margin-top:2px;flex-shrink:0}.info-section[_ngcontent-%COMP%]   .info-item-full[_ngcontent-%COMP%]   .info-label[_ngcontent-%COMP%]{color:var(--text-secondary, #666666)!important;font-size:12px;font-weight:600;text-transform:uppercase;margin:0 0 4px;letter-spacing:.5px}.info-section[_ngcontent-%COMP%]   .info-item-full[_ngcontent-%COMP%]   .info-value[_ngcontent-%COMP%]{color:var(--text-color, #000000)!important;font-size:14px;margin:0;line-height:1.5}.info-section[_ngcontent-%COMP%]   .empty-state[_ngcontent-%COMP%]{text-align:center;padding:40px 20px}.info-section[_ngcontent-%COMP%]   .empty-state[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:64px;color:var(--text-secondary, #cccccc)!important;margin-bottom:16px}.info-section[_ngcontent-%COMP%]   .empty-state[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:var(--text-secondary, #888888)!important;font-size:14px}.info-section[_ngcontent-%COMP%]   .jogadores-list[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:12px}.info-section[_ngcontent-%COMP%]   .jogadores-list[_ngcontent-%COMP%]   .jogador-item[_ngcontent-%COMP%]{display:flex;gap:12px;padding:16px;background:var(--card-background, #f8f9fa);border-radius:8px;align-items:center}.info-section[_ngcontent-%COMP%]   .jogadores-list[_ngcontent-%COMP%]   .jogador-item[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:32px;color:var(--primary-color, #5900F8)!important;flex-shrink:0}.info-section[_ngcontent-%COMP%]   .jogadores-list[_ngcontent-%COMP%]   .jogador-item[_ngcontent-%COMP%]   .jogador-info[_ngcontent-%COMP%]{flex:1}.info-section[_ngcontent-%COMP%]   .jogadores-list[_ngcontent-%COMP%]   .jogador-item[_ngcontent-%COMP%]   .jogador-info[_ngcontent-%COMP%]   .jogador-nome[_ngcontent-%COMP%]{color:var(--text-color, #000000)!important;font-size:16px;font-weight:600;margin:0 0 4px}.info-section[_ngcontent-%COMP%]   .jogadores-list[_ngcontent-%COMP%]   .jogador-item[_ngcontent-%COMP%]   .jogador-info[_ngcontent-%COMP%]   .jogador-email[_ngcontent-%COMP%]{color:var(--text-secondary, #666666)!important;font-size:14px;margin:0}"]});let t=s;return t})();export{Ce as ReservaPage};
