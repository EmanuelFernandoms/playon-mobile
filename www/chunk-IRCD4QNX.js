import{a as l,e as u,g as d,i as p,la as a,ma as m,na as h,zb as o}from"./chunk-GXCPHFE6.js";var j=(()=>{let n=class n{constructor(t){this.http=t,this.currentUserSubject=new l(this.getStoredUser()),this.currentUser$=this.currentUserSubject.asObservable();let e=this.getStoredUser();e&&this.currentUserSubject.next(e)}getFormUrlEncodedParams(t){let e=new m;for(let r in t)t.hasOwnProperty(r)&&(e=e.set(r,t[r]));return e}login(t,e){let r=new a().set("Content-Type","application/x-www-form-urlencoded"),c=this.getFormUrlEncodedParams({email:t,senha:e});return this.http.post(`${o.apiBaseUrl}/startSessionUser`,c.toString(),{headers:r}).pipe(u(s=>{s&&s.id&&this.setUser(s)}))}sendEmailToken(t){let e=new a().set("Content-Type","application/x-www-form-urlencoded"),r=this.getFormUrlEncodedParams({email:t});return console.log("Enviando email token para:",t),this.http.post(`${o.apiBaseUrl}/sendEmailTokenUser`,r.toString(),{headers:e})}register(t,e,r,c){let s={email:t,senha:e,nome:r,telefone:c};return this.http.put(`${o.apiBaseUrl}/registerUser`,s).pipe(u(f=>{this.setUser(f)}))}setUser(t){localStorage.setItem("currentUser",JSON.stringify(t)),this.currentUserSubject.next(t)}getCurrentUser(){return this.currentUserSubject.value}isAuthenticated(){try{let t=localStorage.getItem("currentUser");if(!t||t==="null"||t==="undefined"||t.trim()==="")return!1;let e=JSON.parse(t);return e!=null&&e.id!==void 0&&e.id!==null}catch{return!1}}logout(){localStorage.removeItem("currentUser"),this.currentUserSubject.next(null)}getStoredUser(){try{let t=localStorage.getItem("currentUser");if(!t||t==="null"||t==="undefined"||t.trim()==="")return null;let e=JSON.parse(t);return e&&e.id!==void 0&&e.id!==null?e:null}catch(t){return console.error("Error getting stored user:",t),null}}};n.\u0275fac=function(e){return new(e||n)(p(h))},n.\u0275prov=d({token:n,factory:n.\u0275fac,providedIn:"root"});let i=n;return i})();export{j as a};
