import{e as G,t as Y,u as R,v as B}from"./chunk-IFRWFENO.js";import"./chunk-OJUVZHLW.js";import"./chunk-QUJFQN2Y.js";import"./chunk-FEEG2QC5.js";import"./chunk-SHK2YYVN.js";import"./chunk-23JPK34T.js";import"./chunk-P5KSPTUK.js";import"./chunk-CXLC43CY.js";import"./chunk-RCM5NIA6.js";import"./chunk-7FY2OE2O.js";import"./chunk-DEX3QH37.js";import"./chunk-T27P4ZLZ.js";import"./chunk-VARVFX7A.js";import"./chunk-MTHZ7MWU.js";import"./chunk-WI5MSH4N.js";import"./chunk-5DNE6CQN.js";import"./chunk-CKP3SGE2.js";import"./chunk-AKIS33NR.js";import{a as A}from"./chunk-IRCD4QNX.js";import{$a as N,Ab as H,C as f,F as c,G as o,H as i,I as u,O as w,P as _,Q as g,Ua as F,Wa as p,X as P,Xa as L,Ya as V,Z as r,Za as I,_ as S,_a as z,db as D,eb as j,fb as q,ha as k,ja as y,m as h,n as v,pa as O,sa as T,t as M,u as m,w as x,y as E}from"./chunk-GXCPHFE6.js";import"./chunk-IGVXFY24.js";import"./chunk-5TIAO6TV.js";import"./chunk-BANGDX2W.js";import"./chunk-FZQDFHAZ.js";import"./chunk-CLDSZD2A.js";import"./chunk-M2X7KQLB.js";import"./chunk-XTVTS2NW.js";import"./chunk-OZYWYLNK.js";import"./chunk-42C7ZIID.js";import{e as C}from"./chunk-JHI3MBHO.js";function U(a,d){a&1&&(o(0,"div",16),r(1," Email inv\xE1lido "),i())}function $(a,d){a&1&&(o(0,"div",16),r(1," Senha deve ter no m\xEDnimo 6 caracteres "),i())}function K(a,d){if(a&1){let l=w();o(0,"div",6)(1,"h2"),r(2,"Entrar"),i(),o(3,"form",7),_("ngSubmit",function(){h(l);let e=g();return v(e.onLogin())}),o(4,"div",8)(5,"label",9),r(6,"Email"),i(),u(7,"input",10),i(),f(8,U,2,0,"div",11),o(9,"div",8)(10,"label",9),r(11,"Senha"),i(),u(12,"input",12),i(),f(13,$,2,0,"div",11),o(14,"button",13),r(15," Entrar "),i()(),o(16,"div",14)(17,"p"),r(18,"N\xE3o tem uma conta? "),o(19,"a",15),_("click",function(){h(l);let e=g();return v(e.toggleMode())}),r(20,"Cadastre-se"),i()()()()}if(a&2){let l,t,e=g();m(3),c("formGroup",e.loginForm),m(5),c("ngIf",((l=e.loginForm.get("email"))==null?null:l.invalid)&&((l=e.loginForm.get("email"))==null?null:l.touched)),m(5),c("ngIf",((t=e.loginForm.get("senha"))==null?null:t.invalid)&&((t=e.loginForm.get("senha"))==null?null:t.touched)),m(),c("disabled",e.loginForm.invalid)}}function Q(a,d){a&1&&(o(0,"div",16),r(1," Email inv\xE1lido "),i())}function W(a,d){if(a&1){let l=w();o(0,"div",6)(1,"h2"),r(2,"Criar Conta"),i(),o(3,"form",7),_("ngSubmit",function(){h(l);let e=g();return v(e.onSendEmailToken())}),o(4,"div",8)(5,"label",9),r(6,"Email"),i(),u(7,"input",10),i(),f(8,Q,2,0,"div",11),o(9,"button",13),r(10," Enviar C\xF3digo de Verifica\xE7\xE3o "),i()(),o(11,"div",14)(12,"p"),r(13,"J\xE1 tem uma conta? "),o(14,"a",15),_("click",function(){h(l);let e=g();return v(e.toggleMode())}),r(15,"Entrar"),i()()()()}if(a&2){let l,t=g();m(3),c("formGroup",t.emailTokenForm),m(5),c("ngIf",((l=t.emailTokenForm.get("email"))==null?null:l.invalid)&&((l=t.emailTokenForm.get("email"))==null?null:l.touched)),m(),c("disabled",t.emailTokenForm.invalid)}}function X(a,d){if(a&1){let l=w();o(0,"div",6)(1,"h2"),r(2,"Verificar Email"),i(),o(3,"p",17),r(4,"Digite o c\xF3digo enviado para "),o(5,"strong"),r(6),i()(),o(7,"div",8)(8,"label",9),r(9,"C\xF3digo de Verifica\xE7\xE3o"),i(),u(10,"input",18,0),i(),o(12,"button",19),_("click",function(){h(l);let e=P(11),n=g();return v(n.onVerifyCode(e.value))}),r(13," Verificar C\xF3digo "),i(),o(14,"button",20),_("click",function(){h(l);let e=g();return v(e.step="email")}),r(15," Voltar "),i()()}if(a&2){let l=g();m(6),S(l.userEmail)}}function Z(a,d){a&1&&(o(0,"div",16),r(1," Nome \xE9 obrigat\xF3rio "),i())}function ee(a,d){a&1&&(o(0,"div",16),r(1," Telefone \xE9 obrigat\xF3rio "),i())}function te(a,d){a&1&&(o(0,"div",16),r(1," Senha deve ter no m\xEDnimo 6 caracteres "),i())}function ne(a,d){a&1&&(o(0,"div",16),r(1," As senhas n\xE3o coincidem "),i())}function ie(a,d){if(a&1){let l=w();o(0,"div",6)(1,"h2"),r(2,"Complete seu Cadastro"),i(),o(3,"form",7),_("ngSubmit",function(){h(l);let e=g();return v(e.onRegister())}),o(4,"div",8)(5,"label",9),r(6,"Nome"),i(),u(7,"input",21),i(),f(8,Z,2,0,"div",11),o(9,"div",8)(10,"label",9),r(11,"Telefone"),i(),u(12,"input",22),i(),f(13,ee,2,0,"div",11),o(14,"div",8)(15,"label",9),r(16,"Senha"),i(),u(17,"input",23),i(),f(18,te,2,0,"div",11),o(19,"div",8)(20,"label",9),r(21,"Confirmar Senha"),i(),u(22,"input",24),i(),f(23,ne,2,0,"div",11),o(24,"button",13),r(25," Cadastrar "),i()(),o(26,"button",20),_("click",function(){h(l);let e=g();return v(e.step="email")}),r(27," Voltar "),i()()}if(a&2){let l,t,e,n,s=g();m(3),c("formGroup",s.registerForm),m(5),c("ngIf",((l=s.registerForm.get("nome"))==null?null:l.invalid)&&((l=s.registerForm.get("nome"))==null?null:l.touched)),m(5),c("ngIf",((t=s.registerForm.get("telefone"))==null?null:t.invalid)&&((t=s.registerForm.get("telefone"))==null?null:t.touched)),m(5),c("ngIf",((e=s.registerForm.get("senha"))==null?null:e.invalid)&&((e=s.registerForm.get("senha"))==null?null:e.touched)),m(5),c("ngIf",((n=s.registerForm.get("confirmarSenha"))==null||n.errors==null?null:n.errors.passwordMismatch)&&((n=s.registerForm.get("confirmarSenha"))==null?null:n.touched)),m(),c("disabled",s.registerForm.invalid)}}var he=(()=>{let d=class d{constructor(t,e,n,s,b,J){this.fb=t,this.authService=e,this.router=n,this.loadingController=s,this.toastController=b,this.themeService=J,this.isLoginMode=!0,this.step="login",this.emailToken="",this.userEmail="",this.logoPath="assets/icon/playon vermelho.svg",this.loginForm=this.fb.group({email:["",[p.required,p.email]],senha:["",[p.required,p.minLength(6)]]}),this.emailTokenForm=this.fb.group({email:["",[p.required,p.email]]}),this.registerForm=this.fb.group({nome:["",[p.required]],telefone:["",[p.required]],senha:["",[p.required,p.minLength(6)]],confirmarSenha:["",[p.required]]},{validators:this.passwordMatchValidator})}ngOnInit(){console.log("LoginPage ngOnInit - Componente carregado"),this.authService.isAuthenticated()&&this.router.navigate(["/home"]),this.updateLogo(),this.themeService.darkMode$.subscribe(()=>{this.updateLogo()}),setTimeout(()=>{console.log("LoginForm v\xE1lido:",this.loginForm.valid),console.log("LoginForm controls:",Object.keys(this.loginForm.controls))},100)}updateLogo(){this.logoPath=this.themeService.isDarkMode()?"assets/icon/playon roxo.svg":"assets/icon/playon vermelho.svg"}passwordMatchValidator(t){let e=t.get("senha"),n=t.get("confirmarSenha");return e&&n&&e.value!==n.value?(n.setErrors({passwordMismatch:!0}),{passwordMismatch:!0}):null}toggleMode(){this.isLoginMode=!this.isLoginMode,this.step=this.isLoginMode?"login":"email",this.loginForm.reset(),this.registerForm.reset(),this.emailTokenForm.reset()}onLogin(){return C(this,null,function*(){if(this.loginForm.valid){let t=yield this.loadingController.create({message:"Entrando..."});yield t.present();let{email:e,senha:n}=this.loginForm.value;this.authService.login(e,n).subscribe({next:s=>{t.dismiss(),this.authService.isAuthenticated()?(this.router.navigate(["/home"]),this.showToast("Login realizado com sucesso!","success")):this.showToast("Erro ao fazer login. Tente novamente.","danger")},error:s=>{t.dismiss();let b=s?.error?.message||"Email ou senha incorretos";this.showToast(b,"danger"),console.error("Erro no login:",s)}})}})}onSendEmailToken(){return C(this,null,function*(){if(this.emailTokenForm.valid){let t=yield this.loadingController.create({message:"Enviando c\xF3digo..."});yield t.present();let e=this.emailTokenForm.get("email")?.value;if(console.log("Email do formul\xE1rio:",e),!e){t.dismiss(),this.showToast("Email \xE9 obrigat\xF3rio","danger");return}this.userEmail=e,this.authService.sendEmailToken(e).subscribe({next:n=>{t.dismiss();let s=n?.codigo||n?.token||n?.code||n;this.emailToken=s?String(s):"",console.log("C\xF3digo recebido:",this.emailToken),this.emailToken?(this.step="verify",this.showToast("C\xF3digo enviado para seu email!","success")):this.showToast("Resposta inv\xE1lida do servidor.","danger")},error:n=>{t.dismiss();let s=n?.error?.message||"Erro ao enviar c\xF3digo. Tente novamente.";this.showToast(s,"danger"),console.error("Erro ao enviar c\xF3digo:",n)}})}})}onVerifyCode(t){return C(this,null,function*(){let e=t?String(t).trim():"",n=String(this.emailToken).trim();console.log("C\xF3digo digitado:",e),console.log("C\xF3digo armazenado:",n),console.log("S\xE3o iguais?",e===n),e===n?(this.step="register",this.showToast("C\xF3digo verificado! Preencha seus dados.","success")):this.showToast("C\xF3digo inv\xE1lido. Tente novamente.","danger")})}onRegister(){return C(this,null,function*(){if(this.registerForm.valid){let t=yield this.loadingController.create({message:"Cadastrando..."});yield t.present();let{nome:e,telefone:n,senha:s}=this.registerForm.value;this.authService.register(this.userEmail,s,e,n).subscribe({next:b=>{t.dismiss(),this.router.navigate(["/home"]),this.showToast("Cadastro realizado com sucesso!","success")},error:b=>{t.dismiss(),this.showToast("Erro ao cadastrar. Tente novamente.","danger"),console.error("Erro no cadastro:",b)}})}})}showToast(t,e="success"){return C(this,null,function*(){yield(yield this.toastController.create({message:t,duration:3e3,color:e,position:"bottom"})).present()})}};d.\u0275fac=function(e){return new(e||d)(x(D),x(A),x(T),x(Y),x(R),x(H))},d.\u0275cmp=E({type:d,selectors:[["app-login"]],decls:8,vars:7,consts:[["codigoInput",""],[1,"login-content",3,"fullscreen","scrollY"],[1,"login-container"],[1,"login-header"],["alt","PlayOn",1,"logo",3,"src"],["class","form-container",4,"ngIf"],[1,"form-container"],[3,"ngSubmit","formGroup"],[1,"input-wrapper"],[1,"input-label"],["type","email","formControlName","email","placeholder","seu@email.com","inputmode","email","autocomplete","email","enterkeyhint","next",1,"native-input"],["class","error-message",4,"ngIf"],["type","password","formControlName","senha","placeholder","Digite sua senha","inputmode","text","autocomplete","current-password","enterkeyhint","done",1,"native-input"],["type","submit",1,"login-button","native-button",3,"disabled"],[1,"toggle-mode"],[3,"click"],[1,"error-message"],[1,"info-text"],["type","text","placeholder","Digite o c\xF3digo","maxlength","6","inputmode","numeric","enterkeyhint","done",1,"native-input"],["type","button",1,"login-button","native-button",3,"click"],["type","button",1,"back-button","native-button",3,"click"],["type","text","formControlName","nome","placeholder","Seu nome completo","inputmode","text","autocomplete","name","enterkeyhint","next",1,"native-input"],["type","tel","formControlName","telefone","placeholder","(00) 00000-0000","inputmode","tel","autocomplete","tel","enterkeyhint","next",1,"native-input"],["type","password","formControlName","senha","placeholder","M\xEDnimo 6 caracteres","inputmode","text","autocomplete","new-password","enterkeyhint","next",1,"native-input"],["type","password","formControlName","confirmarSenha","placeholder","Digite a senha novamente","inputmode","text","autocomplete","new-password","enterkeyhint","done",1,"native-input"]],template:function(e,n){e&1&&(o(0,"ion-content",1)(1,"div",2)(2,"div",3),u(3,"img",4),i(),f(4,K,21,4,"div",5)(5,W,16,3,"div",5)(6,X,16,1,"div",5)(7,ie,28,6,"div",5),i()()),e&2&&(c("fullscreen",!0)("scrollY",!0),m(3),c("src",n.logoPath,M),m(),c("ngIf",n.isLoginMode),m(),c("ngIf",!n.isLoginMode&&n.step==="email"),m(),c("ngIf",!n.isLoginMode&&n.step==="verify"),m(),c("ngIf",!n.isLoginMode&&n.step==="register"))},dependencies:[y,k,j,I,F,L,V,q,z,N,B,G,O],styles:[".login-content[_ngcontent-%COMP%]{--background: #ffffff !important;background-color:#fff!important;--padding-top: 20px;--padding-bottom: 20px;--overflow-y: auto;--overflow-x: hidden}.login-content[_ngcontent-%COMP%]     .scroll-content{pointer-events:auto!important;touch-action:manipulation!important}.login-content[_ngcontent-%COMP%]:before, .login-content[_ngcontent-%COMP%]:after{display:none!important;pointer-events:none!important}.login-container[_ngcontent-%COMP%]{width:100%;max-width:400px;padding:20px;margin:0 auto;position:relative;z-index:1;pointer-events:auto!important}.login-header[_ngcontent-%COMP%]{text-align:center;margin-bottom:40px}.login-header[_ngcontent-%COMP%]   .logo[_ngcontent-%COMP%]{width:120px;height:auto;margin-bottom:16px}.login-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{color:#5900f8!important;font-size:32px;font-weight:700;margin:0}.form-container[_ngcontent-%COMP%]{pointer-events:auto!important;position:relative;z-index:2}.form-container[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{color:#000!important;font-size:24px;font-weight:600;margin:0 0 24px;text-align:center;pointer-events:none}.form-container[_ngcontent-%COMP%]   .info-text[_ngcontent-%COMP%]{color:#666!important;font-size:14px;text-align:center;margin-bottom:20px;pointer-events:none}.form-container[_ngcontent-%COMP%]   .info-text[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{color:#000!important}.form-container[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]{pointer-events:auto!important}.input-wrapper[_ngcontent-%COMP%]{background:#f5f5f5!important;border-radius:8px;margin-bottom:16px;padding:16px;position:relative;pointer-events:auto!important;touch-action:manipulation;min-height:56px;display:flex;flex-direction:column;justify-content:center}.input-wrapper[_ngcontent-%COMP%]   .input-label[_ngcontent-%COMP%]{color:#000!important;font-weight:500;font-size:14px;margin-bottom:8px;pointer-events:none}.input-wrapper[_ngcontent-%COMP%]   .native-input[_ngcontent-%COMP%]{width:100%;border:none;outline:none;background:transparent;color:#000!important;font-size:16px;padding:0;margin:0;pointer-events:auto!important;touch-action:manipulation;-webkit-user-select:text;user-select:text;min-height:24px;-webkit-appearance:none;appearance:none}.input-wrapper[_ngcontent-%COMP%]   .native-input[_ngcontent-%COMP%]::placeholder{color:#999;opacity:1}.input-wrapper[_ngcontent-%COMP%]   .native-input[_ngcontent-%COMP%]:focus{outline:none}ion-item[_ngcontent-%COMP%]{--background: #f5f5f5 !important;background-color:#f5f5f5!important;--border-radius: 8px;margin-bottom:16px;--padding-start: 16px;--padding-end: 16px;--inner-padding-end: 0;--inner-padding-start: 0;--min-height: 56px;pointer-events:auto!important;touch-action:manipulation;position:relative;z-index:10}.error-message[_ngcontent-%COMP%]{color:#eb445a!important;font-size:12px;margin:-12px 0 8px 16px}.login-button[_ngcontent-%COMP%], .native-button.login-button[_ngcontent-%COMP%]{background:#5900f8!important;color:#fff!important;border-radius:8px;border:none;margin-top:24px;width:100%;height:48px;font-weight:600;text-transform:none;font-size:16px;pointer-events:auto!important;touch-action:manipulation;-webkit-tap-highlight-color:transparent;cursor:pointer;display:block;transition:all .2s ease}.login-button[_ngcontent-%COMP%]:hover:not(:disabled), .native-button.login-button[_ngcontent-%COMP%]:hover:not(:disabled){background:#4a00d4!important;transform:translateY(-1px);box-shadow:0 4px 8px #5900f84d}.login-button[_ngcontent-%COMP%]:active:not(:disabled), .native-button.login-button[_ngcontent-%COMP%]:active:not(:disabled){transform:translateY(0);box-shadow:0 2px 4px #5900f833}.login-button[_ngcontent-%COMP%]:disabled, .native-button.login-button[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed;pointer-events:none}.back-button[_ngcontent-%COMP%], .native-button.back-button[_ngcontent-%COMP%]{color:#5900f8!important;background:#5900f814!important;border:none;border-radius:12px;padding:12px 16px;margin:16px 0;width:100%;font-weight:600;font-size:15px;text-transform:none;letter-spacing:.3px;box-shadow:0 2px 4px #5900f81a;transition:all .2s ease;cursor:pointer;pointer-events:auto!important;touch-action:manipulation;-webkit-tap-highlight-color:transparent;display:block}.back-button[_ngcontent-%COMP%]:hover, .native-button.back-button[_ngcontent-%COMP%]:hover{background:#5900f81f!important;transform:translateY(-1px);box-shadow:0 4px 8px #5900f826}.back-button[_ngcontent-%COMP%]:active, .native-button.back-button[_ngcontent-%COMP%]:active{background:#5900f829!important;transform:translateY(0)}.toggle-mode[_ngcontent-%COMP%]{text-align:center;margin-top:24px;pointer-events:auto!important;position:relative;z-index:2}.toggle-mode[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#666!important;font-size:14px;margin:0;pointer-events:none}.toggle-mode[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:#5900f8!important;font-weight:600;text-decoration:none;cursor:pointer;pointer-events:auto!important;touch-action:manipulation;-webkit-tap-highlight-color:transparent;display:inline-block;padding:4px 8px;margin-left:4px}.toggle-mode[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{text-decoration:underline}.toggle-mode[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:active{opacity:.7}"]});let a=d;return a})();export{he as LoginPage};
